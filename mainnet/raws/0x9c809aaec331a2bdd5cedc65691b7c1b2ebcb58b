{"status": "1", "message": "OK", "result": [{"SourceCode": "// File: @openzeppelin/contracts/utils/Strings.sol\r\n\r\n\r\n// OpenZeppelin Contracts v4.4.0 (utils/Strings.sol)\r\n\r\npragma solidity ^0.8.0;\r\n\r\n/**\r\n * @dev String operations.\r\n */\r\nlibrary Strings {\r\n    bytes16 private constant _HEX_SYMBOLS = \"0123456789abcdef\";\r\n\r\n    /**\r\n     * @dev Converts a `uint256` to its ASCII `string` decimal representation.\r\n     */\r\n    function toString(uint256 value) internal pure returns (string memory) {\r\n        // Inspired by OraclizeAPI's implementation - MIT licence\r\n        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol\r\n\r\n        if (value == 0) {\r\n            return \"0\";\r\n        }\r\n        uint256 temp = value;\r\n        uint256 digits;\r\n        while (temp != 0) {\r\n            digits++;\r\n            temp /= 10;\r\n        }\r\n        bytes memory buffer = new bytes(digits);\r\n        while (value != 0) {\r\n            digits -= 1;\r\n            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));\r\n            value /= 10;\r\n        }\r\n        return string(buffer);\r\n    }\r\n\r\n    /**\r\n     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.\r\n     */\r\n    function toHexString(uint256 value) internal pure returns (string memory) {\r\n        if (value == 0) {\r\n            return \"0x00\";\r\n        }\r\n        uint256 temp = value;\r\n        uint256 length = 0;\r\n        while (temp != 0) {\r\n            length++;\r\n            temp >>= 8;\r\n        }\r\n        return toHexString(value, length);\r\n    }\r\n\r\n    /**\r\n     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.\r\n     */\r\n    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {\r\n        bytes memory buffer = new bytes(2 * length + 2);\r\n        buffer[0] = \"0\";\r\n        buffer[1] = \"x\";\r\n        for (uint256 i = 2 * length + 1; i > 1; --i) {\r\n            buffer[i] = _HEX_SYMBOLS[value & 0xf];\r\n            value >>= 4;\r\n        }\r\n        require(value == 0, \"Strings: hex length insufficient\");\r\n        return string(buffer);\r\n    }\r\n}\r\n\r\n// File: ACE.sol\r\n\r\n\r\n// SPDX-License-Identifier: UNLICENSED\r\n\r\npragma solidity ^0.8.4;\r\n\r\ninterface IERC20 {\r\n    function balanceOf(address account) external view returns (uint256);\r\n    function transfer(address to, uint256 amount) external returns (bool);\r\n    function transferFrom(\r\n        address from,\r\n        address to,\r\n        uint256 amount\r\n    ) external returns (bool);\r\n}\r\n\r\ncontract ACED {\r\n    address owner;\r\n    address buyer;\r\n    address seller;\r\n\r\n    constructor() {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    receive() external payable {}\r\n\r\n    function setBuyer(address _address) external {\r\n        require(msg.sender == owner);\r\n        buyer = _address;\r\n    }\r\n    function setSeller(address _address) external {\r\n        require(msg.sender == owner);\r\n        seller = _address;\r\n    }\r\n\r\n    function withdraw(bool _native, address _to, uint256 _amount, address _tokenAddress) external {        \r\n        require(msg.sender == owner && (_to == buyer || _to == seller), \"160\");\r\n\r\n        if(_native) {\r\n            payable(_to).transfer(_amount);\r\n        } else {\r\n            IERC20 crypto1 = IERC20(address(_tokenAddress));\r\n            require(crypto1.transfer(_to, _amount), \"161\");\r\n        }     \r\n    }\r\n}\r\n\r\n/// @title Antonomous Crypto Escrow Smart Contract\r\n/// @author ADC\r\ncontract ACE {\r\n\r\n    // Created escrow number\r\n    uint256 public counter;\r\n\r\n    // Escrow ID <-> Escrow mapping\r\n    mapping(bytes32 => AnscaEscrow) anscaEscrowList;\r\n    // Wallet reputation information\r\n    mapping(address => AnscaReputation) reputation;\r\n    // Wallet <-> Escrow ID mapping\r\n    mapping(address => bytes32[]) ownerEscrowMapping;\r\n    // Protocol Fee\r\n    uint256 public FEE = 75; //75 = 0.75%\r\n    // Time unit\r\n    uint256 public dayInSecond;\r\n    // If the contract is paused\r\n    bool public paused;\r\n\r\n    \r\n    address owner;\r\n    // Address receiving escrow fees\r\n    address feeCollectorAddress;\r\n\r\n    // List of escrow states\r\n    enum State{ NULL, NEW_SELLER, ONGOING, ONGOING_LOCKED, DISPUTE, COMPLETE }\r\n    // List of user actions\r\n    enum Action{ NULL, CREATE, CANCEL, DEPOSIT, WITHDRAW, VALIDATE, LOCK, UNLOCK, NEW_DELIVERY_TIME_REQUEST, ACCEPT_NEW_DELIVERY_TIME_REQUEST, DISCOUNT_REQUEST, ACCEPT_DISCOUNT_REQUEST }\r\n    \r\n    // Escrow model\r\n    struct AnscaEscrow {\r\n        bytes32 id;\r\n        bytes32 label;\r\n        address tokenAddress;\r\n        bytes32 buyerStrVar;\r\n        bytes32 sellerStrVar;\r\n        uint256 amount;\r\n        uint256 amountMinusFee;\r\n        uint256 startTimestamp;        \r\n        uint256 creationTimestamp;\r\n        uint256 lockTimestamp;\r\n        uint256 unlockTimestamp;\r\n        uint256 buyerLastActionDate;\r\n        uint256 sellerLastActionDate;\r\n        uint32 deliveryTime;\r\n        uint32 buyerNbrVar;\r\n        uint32 sellerNbrVar;\r\n        uint32 discount;        \r\n        bool native;\r\n        bool sellerHasReceivedHisShare;\r\n        bool buyerHasReceivedHisShare;\r\n        bool dispute;\r\n        Action buyerLastAction;\r\n        Action sellerLastAction;\r\n        State state;\r\n        address buyer;\r\n        address buyerHandler;\r\n        address seller;        \r\n        address sellerHandler;\r\n        address depositContract;\r\n    }\r\n\r\n    // Wallet reputation information model\r\n    struct AnscaReputation {\r\n        uint256 escrowNumber;\r\n        uint256 disputeNumber;\r\n        uint256 firstEscrowDate;\r\n        uint256 lastEscrowDate;\r\n    }\r\n\r\n    event ACEEvent(address from, address indexed buyer ,address indexed seller, bytes32 indexed id, uint8 action);\r\n\r\n    event CompleteEvent(bytes32 indexed id, uint256 amount, bool dispute, address indexed buyer, address indexed seller, address tokenAddress);\r\n\r\n    constructor(address _feeCollectorAddress, uint256 _dayInSecond) {\r\n        owner = msg.sender;\r\n        feeCollectorAddress = _feeCollectorAddress;\r\n        dayInSecond = _dayInSecond;\r\n    }\r\n\r\n    /// @notice Get the escrow information by ID\r\n    /// @param _id Id of the escrow\r\n    function getEscrowById(bytes32 _id) external view returns(string memory) {\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n\r\n        string memory resultPart1;\r\n        string memory resultPart2;\r\n        string memory resultPart3;\r\n        string memory resultPart4;  \r\n\r\n        {\r\n            resultPart1 = string(abi.encodePacked(\r\n            localAnscaEscrow.id,\r\n            \";\",\r\n            localAnscaEscrow.native ? \"TRUE\" : \"FALSE\",\r\n            \";\",\r\n            Strings.toHexString(uint256(uint160(address(localAnscaEscrow.tokenAddress)))),\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.amount),\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.discount)),\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.deliveryTime)),\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.startTimestamp)));\r\n        }\r\n\r\n        {\r\n            resultPart2 = string(abi.encodePacked(\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.state)),\r\n            \";\",\r\n            Strings.toHexString(uint256(uint160(address(localAnscaEscrow.buyer)))),\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.buyerLastAction)),\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.buyerLastActionDate),\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.buyerNbrVar)),\r\n            \";\",\r\n            localAnscaEscrow.buyerStrVar,\r\n            \";\",\r\n            localAnscaEscrow.buyerHasReceivedHisShare ? \"TRUE\" : \"FALSE\"));\r\n        }\r\n\r\n        {\r\n            resultPart3 = string(abi.encodePacked(\r\n            \";\",\r\n            Strings.toHexString(uint256(uint160(address(localAnscaEscrow.seller)))),\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.sellerLastAction)),\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.sellerLastActionDate),\r\n            \";\",\r\n            Strings.toString(uint256(localAnscaEscrow.sellerNbrVar)),\r\n            \";\",\r\n            localAnscaEscrow.sellerStrVar,\r\n            \";\",\r\n            localAnscaEscrow.sellerHasReceivedHisShare ? \"TRUE\" : \"FALSE\",\r\n            \";\",\r\n            localAnscaEscrow.label,\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.creationTimestamp)\r\n            ));\r\n        }\r\n        {\r\n            resultPart4 = string(abi.encodePacked(\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.lockTimestamp),\r\n            \";\",\r\n            Strings.toString(localAnscaEscrow.unlockTimestamp),\r\n            \";\",\r\n            Strings.toHexString(uint256(uint160(address(localAnscaEscrow.buyerHandler)))),\r\n            \";\",\r\n            Strings.toHexString(uint256(uint160(address(localAnscaEscrow.sellerHandler))))\r\n            ));\r\n        }\r\n        \r\n        return string(abi.encodePacked(resultPart1, resultPart2, resultPart3, resultPart4));\r\n    }\r\n\r\n    /// @notice Get the address reputation\r\n    /// @param _address the address for wich we want to retreive the reputation\r\n    function getAddressReputation(address _address) external view returns(string memory){\r\n        return string(abi.encodePacked(\r\n            Strings.toString(reputation[_address].escrowNumber),\r\n            \";\",\r\n            Strings.toString(reputation[_address].disputeNumber),\r\n            \";\",\r\n            Strings.toString(reputation[_address].firstEscrowDate),\r\n            \";\",\r\n            Strings.toString(reputation[_address].lastEscrowDate)\r\n            ));\r\n    }\r\n\r\n    /// @notice True if the escrow ended without going into dispute\r\n    /// @param _id Id of the escrow\r\n    function escrowWentWell(bytes32 _id) external view returns(bool) {\r\n        return anscaEscrowList[_id].state == State.COMPLETE && !anscaEscrowList[_id].dispute;\r\n    }\r\n\r\n    /// @notice True if the provided address is involved in the escrow\r\n    /// @param _id Id of the escrow\r\n    /// @param _address the address to check\r\n    function addressIsInvolved(bytes32 _id, address _address) external view returns(bool) {\r\n        return anscaEscrowList[_id].buyer == _address || anscaEscrowList[_id].seller == _address;\r\n    }\r\n\r\n    // ##############################################################\r\n    // #####                                                    #####\r\n    // ################# Buyer and Seller actions ###################\r\n    // #####                                                    #####\r\n    // ##############################################################\r\n\r\n    /// @notice Creates a new crypto escrow. Can be called by the buyer or the seller. If called by the buyer, the deposit is made at the same time and the escrow goes to the ONGOING state. If called by the seller, the escrow is still in the NEW state and waits for the buyer deposit to pass to the ONGOING state\r\n    /// @param _id Id of the escrow\r\n    /// @param _native Whether the native blockchain token is used or one from a deployed ERC20 smart contract\r\n    /// @param _tokenAddress The smart contract address of the ERC20 token if applicable\r\n    /// @param _amount The amount to lock in the escrow\r\n    /// @param _deliveryTime The duration of this escrow before it goes to the dispute state. Can be modify later if the parties come to an agreement\r\n    /// @param _label A description for this escrow\r\n    /// @param _asBuyer If it is the buyer who initiate this creation\r\n    /// @param _sellerAddress the address of the seller filled in by the buyer if applicable\r\n    function createEscrow(bytes32 _id, bool _native, address _tokenAddress, uint256 _amount, uint32 _deliveryTime, bytes32 _label, bool _asBuyer, address _sellerAddress, address _handlerAddress)  external payable {\r\n        //Checks\r\n        require(!paused, \"50\");\r\n        require(anscaEscrowList[_id].id != _id || \r\n            (anscaEscrowList[_id].sellerHasReceivedHisShare && anscaEscrowList[_id].buyerHasReceivedHisShare) ||\r\n            (anscaEscrowList[_id].sellerHasReceivedHisShare && anscaEscrowList[_id].discount == 0) || \r\n            (anscaEscrowList[_id].buyerHasReceivedHisShare && anscaEscrowList[_id].discount == 100) ||\r\n            (anscaEscrowList[_id].state == State.NEW_SELLER && block.timestamp > (anscaEscrowList[_id].creationTimestamp + 30 * dayInSecond)) ,\"51\");\r\n        require(_deliveryTime >= dayInSecond, \"53\");\r\n        if(!_native) {\r\n            require(_tokenAddress != address(0), \"54\");\r\n        } else {\r\n            _tokenAddress = address(0);\r\n        }\r\n\r\n        //States\r\n        AnscaEscrow memory localAnscaEscrow = AnscaEscrow({\r\n            id: _id,\r\n            label: _label,\r\n            native: _native,\r\n            tokenAddress: _tokenAddress,\r\n            amount: _amount,\r\n            amountMinusFee: _amount - (_amount * FEE) / 10000,\r\n            discount: 0,\r\n            deliveryTime: _deliveryTime,\r\n            startTimestamp: _asBuyer ? block.timestamp : 0,\r\n            lockTimestamp: 0,\r\n            unlockTimestamp: 0,\r\n            state: _asBuyer ? State.ONGOING : State.NEW_SELLER,\r\n            buyer: _asBuyer ? address(msg.sender) : address(0),\r\n            buyerHandler: _asBuyer ? _handlerAddress : address(0),\r\n            buyerLastAction: _asBuyer ? Action.CREATE : Action.NULL,\r\n            buyerLastActionDate: _asBuyer ? block.timestamp : 0,\r\n            buyerNbrVar: 0,\r\n            buyerStrVar: \"\",\r\n            buyerHasReceivedHisShare: false,\r\n            seller: _asBuyer ? _sellerAddress : address(msg.sender),\r\n            sellerHandler: _asBuyer ? address(0) : _handlerAddress,\r\n            sellerLastAction: _asBuyer ? Action.NULL : Action.CREATE,\r\n            sellerLastActionDate: _asBuyer ? 0 : block.timestamp,\r\n            sellerNbrVar: 0,\r\n            sellerStrVar: \"\",\r\n            sellerHasReceivedHisShare: false,\r\n            creationTimestamp: block.timestamp,\r\n            depositContract: address(0),\r\n            dispute: false\r\n            });\r\n\r\n            anscaEscrowList[_id] = localAnscaEscrow;            \r\n            if(_asBuyer) {     \r\n                require(msg.sender != _sellerAddress && _sellerAddress != address(0), \"55\");           \r\n                ownerEscrowMapping[localAnscaEscrow.seller].push(_id);\r\n                if(_native) {\r\n                    nativeDepositInternal(localAnscaEscrow);\r\n                } else {\r\n                    depositInternal(localAnscaEscrow);\r\n                }                \r\n            } else {                \r\n                ownerEscrowMapping[msg.sender].push(_id);\r\n            }\r\n            emitACEEvent(msg.sender, localAnscaEscrow.buyer, localAnscaEscrow.seller, _id, Action.CREATE); \r\n            counter++;\r\n    }\r\n\r\n    /// @notice returns all the escrow ID for the calling wallet\r\n    function getAllEscrowsForSender() external view returns(bytes32[] memory){\r\n        return ownerEscrowMapping[msg.sender];\r\n    }\r\n\r\n    // ONGOING or DISPUTE\r\n    /// @notice Allow the buyer and the seller to make a discount proposal. If the escrow is in DISPUTE state, both parties have only 24 hours after the proposal of the other party to make a discount proposal\r\n    /// @param _id The escrow ID\r\n    /// @param _discount The discount value like \"10\" for 10%\r\n    function proposeAmountDiscount(bytes32 _id, uint32 _discount) external {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(isSellerParty(localAnscaEscrow, msg.sender) || isBuyerParty(localAnscaEscrow, msg.sender), \"10\");\r\n        require(_discount >= 0 && _discount <= 100, \"11\");\r\n        bool localisInOrGoingToBeDispute = isInOrGoingToBeDispute(localAnscaEscrow, false);\r\n        require(isInOrGoingToBeOngoing(localAnscaEscrow, false) || localisInOrGoingToBeDispute, \"12\");\r\n\r\n        //States        \r\n        if(localAnscaEscrow.state != State.DISPUTE && localisInOrGoingToBeDispute) {\r\n            localAnscaEscrow.state = State.DISPUTE;            \r\n            reputation[localAnscaEscrow.buyer].disputeNumber++;\r\n        }\r\n        if(localAnscaEscrow.state == State.DISPUTE && !localAnscaEscrow.dispute && ((localAnscaEscrow.sellerLastAction != Action.NULL && localAnscaEscrow.sellerLastAction != Action.CREATE) || isSellerParty(localAnscaEscrow, msg.sender))  ) {\r\n            localAnscaEscrow.dispute = true;\r\n            reputation[localAnscaEscrow.seller].disputeNumber++;\r\n        }\r\n\r\n        if(localAnscaEscrow.state == State.ONGOING || localAnscaEscrow.state == State.ONGOING_LOCKED) {\r\n            if(\r\n                (isSellerParty(localAnscaEscrow, msg.sender) && \r\n                localAnscaEscrow.buyerLastAction == Action.DISCOUNT_REQUEST && \r\n                localAnscaEscrow.buyerNbrVar == _discount)\r\n                ||\r\n                (isBuyerParty(localAnscaEscrow, msg.sender) && \r\n                localAnscaEscrow.sellerLastAction == Action.DISCOUNT_REQUEST && \r\n                localAnscaEscrow.sellerNbrVar == _discount)                \r\n            ) {\r\n                updateAction(localAnscaEscrow, msg.sender, Action.ACCEPT_DISCOUNT_REQUEST, _discount, \"\");\r\n                localAnscaEscrow.discount = _discount;\r\n            } else {\r\n                updateAction(localAnscaEscrow, msg.sender, Action.DISCOUNT_REQUEST, _discount, \"\");\r\n            }\r\n\r\n        } else if(localAnscaEscrow.state == State.DISPUTE) {\r\n            if(\r\n                (isSellerParty(localAnscaEscrow, msg.sender) && \r\n                localAnscaEscrow.buyerLastAction == Action.DISCOUNT_REQUEST &&\r\n                localAnscaEscrow.buyerLastActionDate > (localAnscaEscrow.startTimestamp + localAnscaEscrow.deliveryTime) &&\r\n                (block.timestamp > (localAnscaEscrow.buyerLastActionDate + dayInSecond) || localAnscaEscrow.buyerNbrVar == _discount))\r\n                ||\r\n                (isBuyerParty(localAnscaEscrow, msg.sender) && \r\n                localAnscaEscrow.sellerLastAction == Action.DISCOUNT_REQUEST &&\r\n                localAnscaEscrow.sellerLastActionDate > (localAnscaEscrow.startTimestamp + localAnscaEscrow.deliveryTime) &&\r\n                (block.timestamp > (localAnscaEscrow.sellerLastActionDate + dayInSecond) || localAnscaEscrow.sellerNbrVar == _discount))\r\n                ) {\r\n                    if((isSellerParty(localAnscaEscrow, msg.sender) && localAnscaEscrow.buyerNbrVar == _discount) || (isBuyerParty(localAnscaEscrow, msg.sender) && localAnscaEscrow.sellerNbrVar == _discount)) {\r\n                        updateAction(localAnscaEscrow, msg.sender, Action.ACCEPT_DISCOUNT_REQUEST, _discount, \"\");\r\n                    } else {\r\n                        updateAction(localAnscaEscrow, msg.sender, Action.DISCOUNT_REQUEST, _discount, \"\");\r\n                    }\r\n                localAnscaEscrow.state = State.COMPLETE;\r\n            } else {\r\n                localAnscaEscrow.discount = _discount;\r\n                updateAction(localAnscaEscrow, msg.sender, Action.DISCOUNT_REQUEST, _discount, \"\");\r\n            }            \r\n        }\r\n        \r\n        anscaEscrowList[_id] = localAnscaEscrow;\r\n    }\r\n\r\n    // COMPLETE\r\n    /// @notice Allow both parties to withdraw their funds from the escrow if the case may be. If everything went well and there is no discount, only the seller can make a withdrawal. If there is a discount both the buyer and the seller are able to make a withdrawl. If the seller has CANCELED the escrow, only the buyer can make a withdrawl of all his funds.  \r\n    /// @param _id The escrow ID\r\n    function withdraw(bytes32 _id) external {\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        \r\n        //Checks 1 \r\n        bool localIsBuyerParty = isBuyerParty(localAnscaEscrow, msg.sender);\r\n        bool localIsSellerParty = isSellerParty(localAnscaEscrow, msg.sender);\r\n        require(localIsBuyerParty || localIsSellerParty, \"40\");\r\n\r\n        //States 1\r\n        if (isInOrGoingToBeComplete(localAnscaEscrow, false)) {\r\n            localAnscaEscrow.state = State.COMPLETE;\r\n        } else if (localAnscaEscrow.state == State.DISPUTE) {\r\n            uint32 finalDiscount = localAnscaEscrow.discount;\r\n            uint256 bts = block.timestamp;\r\n            if(bts > (localAnscaEscrow.startTimestamp + localAnscaEscrow.deliveryTime + dayInSecond)) {\r\n                if(bts > (localAnscaEscrow.sellerLastActionDate + dayInSecond) && bts > (localAnscaEscrow.buyerLastActionDate + dayInSecond)) {\r\n                    if(localAnscaEscrow.sellerLastAction == Action.DISCOUNT_REQUEST) {\r\n                        finalDiscount = localAnscaEscrow.sellerNbrVar;\r\n                    }\r\n                    if(localAnscaEscrow.buyerLastAction == Action.DISCOUNT_REQUEST && localAnscaEscrow.buyerLastActionDate > localAnscaEscrow.sellerLastActionDate) {\r\n                        finalDiscount = localAnscaEscrow.buyerNbrVar;\r\n                    }                \r\n                    localAnscaEscrow.discount = finalDiscount;\r\n                    localAnscaEscrow.state = State.COMPLETE;\r\n                }\r\n            }            \r\n        }        \r\n        \r\n        //Checks\r\n        require(localAnscaEscrow.state == State.COMPLETE, \"41\");\r\n\r\n        //States 2\r\n        updateAction(localAnscaEscrow, msg.sender, Action.WITHDRAW, 0, \"\");\r\n\r\n        payParty(localAnscaEscrow, localIsBuyerParty ? localAnscaEscrow.buyer : localAnscaEscrow.seller);\r\n    }\r\n\r\n    function changeHandler(bytes32 _id, address _address) external {\r\n        if(msg.sender == anscaEscrowList[_id].buyer) {\r\n            require(_address != anscaEscrowList[_id].sellerHandler);\r\n            anscaEscrowList[_id].buyerHandler = _address;\r\n        } else if (msg.sender == anscaEscrowList[_id].seller) {\r\n            require(_address != anscaEscrowList[_id].buyerHandler);\r\n            anscaEscrowList[_id].sellerHandler = _address;\r\n        }\r\n    }\r\n\r\n    // ##############################################################\r\n    // #####                                                    #####\r\n    // ####################### Seller actions #######################\r\n    // #####                                                    #####\r\n    // ##############################################################\r\n    \r\n    /// @notice Allow the seller to cancel the escrow. This unlocks all the funds to the buyer\r\n    /// @param _id The escrow ID\r\n    function cancelEscrow(bytes32 _id) external {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(isSellerParty(localAnscaEscrow, msg.sender), \"60\");\r\n        \r\n        //States\r\n        updateAction(localAnscaEscrow, msg.sender, Action.CANCEL, 0, \"\");\r\n        localAnscaEscrow.discount = 100;\r\n        localAnscaEscrow.state = State.COMPLETE;        \r\n        anscaEscrowList[_id] = localAnscaEscrow;\r\n\r\n        //Actions\r\n        payParties(localAnscaEscrow);\r\n    }\r\n\r\n    // ONGOING\r\n    /// @notice Allow the seller to make a delivery time change request. This request must be accepted for the new deadline to be taken into account \r\n    /// @param _id The escrow ID \r\n    /// @param _deliveryTime The new delivery time proposal\r\n    function proposeNewDeliveryTime(bytes32 _id, uint32 _deliveryTime) external {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(isSellerParty(localAnscaEscrow, msg.sender) && _deliveryTime > localAnscaEscrow.deliveryTime, \"70\");\r\n        isInOrGoingToBeOngoing(localAnscaEscrow, true);\r\n\r\n        //States\r\n        updateAction(localAnscaEscrow, msg.sender, Action.NEW_DELIVERY_TIME_REQUEST, _deliveryTime, \"\");\r\n        anscaEscrowList[_id] = localAnscaEscrow;\r\n    }\r\n\r\n    // ##############################################################\r\n    // #####                                                    #####\r\n    // ####################### Buyer actions #######################\r\n    // #####                                                    #####\r\n    // ##############################################################\r\n\r\n    // NEW\r\n    /// @notice Allows the buyer to make the deposit in case of a seller escrow creation. Once the deposit is made the escrow goes to the ONGOING state.\r\n    /// @param _id The escrow ID\r\n    function deposit(bytes32 _id, address _handlerAddress) external payable {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(localAnscaEscrow.state == State.NEW_SELLER && localAnscaEscrow.seller != msg.sender, \"80\");\r\n\r\n        updateAction(localAnscaEscrow, msg.sender, Action.DEPOSIT, 0, \"\");\r\n        localAnscaEscrow.buyerHandler = _handlerAddress;\r\n        if(localAnscaEscrow.native) {\r\n            nativeDepositInternal(localAnscaEscrow);\r\n        } else {\r\n            depositInternal(localAnscaEscrow);  \r\n        }        \r\n    }\r\n\r\n    function nativeDepositInternal(AnscaEscrow memory localAnscaEscrow) internal {\r\n        //Checks\r\n        require(localAnscaEscrow.native && msg.value >= localAnscaEscrow.amount, \"90\");\r\n\r\n        //States\r\n        preDeposit(localAnscaEscrow);\r\n\r\n        //Actions\r\n        payable(localAnscaEscrow.depositContract).transfer(localAnscaEscrow.amountMinusFee);\r\n        payable(feeCollectorAddress).transfer(localAnscaEscrow.amount - localAnscaEscrow.amountMinusFee);\r\n    }\r\n\r\n    function depositInternal(AnscaEscrow memory localAnscaEscrow) internal {\r\n        //Checks 1        \r\n        require(!localAnscaEscrow.native, \"82\");\r\n\r\n        //States\r\n        preDeposit(localAnscaEscrow);\r\n        \r\n        //Actions\r\n        IERC20 crypto = IERC20(address(localAnscaEscrow.tokenAddress));      \r\n        bool success = crypto.transferFrom(msg.sender, localAnscaEscrow.depositContract, localAnscaEscrow.amountMinusFee);\r\n        success = crypto.transferFrom(msg.sender, feeCollectorAddress, localAnscaEscrow.amount - localAnscaEscrow.amountMinusFee);\r\n        require(success);\r\n    }\r\n\r\n    function preDeposit(AnscaEscrow memory localAnscaEscrow) internal {  \r\n        //Checks\r\n        require(localAnscaEscrow.seller != msg.sender, \"81\");\r\n\r\n        //States        \r\n        if(localAnscaEscrow.state == State.NEW_SELLER) {\r\n            localAnscaEscrow.buyer = msg.sender;\r\n        }\r\n        startEscrow(localAnscaEscrow);     \r\n        ownerEscrowMapping[msg.sender].push(localAnscaEscrow.id);\r\n\r\n        anscaEscrowList[localAnscaEscrow.id] = localAnscaEscrow;\r\n    }\r\n\r\n    // ONGOING\r\n    /// @notice Enable the buyer to accept a previous delivery time change request made by the seller. When accepted, the new delivery time replace the previous one\r\n    /// @param _id The escrow ID\r\n    function acceptNewDeliveryTime(bytes32 _id) external {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(isBuyerParty(localAnscaEscrow, msg.sender) && localAnscaEscrow.sellerLastAction == Action.NEW_DELIVERY_TIME_REQUEST && localAnscaEscrow.buyerLastActionDate < localAnscaEscrow.sellerLastActionDate, \"100\");\r\n        isInOrGoingToBeOngoing(localAnscaEscrow, true);\r\n\r\n        //States\r\n        updateAction(localAnscaEscrow, msg.sender, Action.ACCEPT_NEW_DELIVERY_TIME_REQUEST, 0, \"\");\r\n        localAnscaEscrow.deliveryTime = localAnscaEscrow.sellerNbrVar;\r\n        anscaEscrowList[_id] = localAnscaEscrow;\r\n    }\r\n\r\n    // ONGOING\r\n    /// @notice Allow the buyer to lock or unlock an escrow. A locked escrow will automatically go in the dispute state at the end of teh delivery time\r\n    /// @param _id The escrow ID\r\n    /// @param _lock True to lock, false to unlock\r\n    function lock(bytes32 _id, bool _lock) external {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(isBuyerParty(localAnscaEscrow, msg.sender), \"110\");\r\n        isInOrGoingToBeOngoing(localAnscaEscrow, true);\r\n\r\n        //States\r\n        if(_lock) {\r\n            localAnscaEscrow.state = State.ONGOING_LOCKED;\r\n            localAnscaEscrow.lockTimestamp = block.timestamp;\r\n            emitACEEvent(localAnscaEscrow.buyer, localAnscaEscrow.buyer, localAnscaEscrow.seller, _id, Action.LOCK); \r\n        } else {\r\n            localAnscaEscrow.state = State.ONGOING;\r\n            localAnscaEscrow.unlockTimestamp = block.timestamp;\r\n            emitACEEvent(localAnscaEscrow.buyer, localAnscaEscrow.buyer, localAnscaEscrow.seller, _id, Action.UNLOCK); \r\n        }  \r\n        anscaEscrowList[_id] = localAnscaEscrow;\r\n    }\r\n\r\n    // ONGOING\r\n    /// @notice Enable the buyer to validate the escrow before the end of the delivery time. It will passes the escrow in the complete state and allow the parties to withdraw there funds\r\n    /// @param _id The escrow ID\r\n    function validateEscrow(bytes32 _id) external {\r\n        //Checks\r\n        AnscaEscrow memory localAnscaEscrow = anscaEscrowList[_id];\r\n        require(isBuyerParty(localAnscaEscrow, msg.sender), \"130\");\r\n        isInOrGoingToBeOngoing(localAnscaEscrow, true);\r\n\r\n        //States\r\n        updateAction(localAnscaEscrow, msg.sender, Action.VALIDATE, 0, \"\");\r\n        localAnscaEscrow.state = State.COMPLETE;        \r\n        anscaEscrowList[_id] = localAnscaEscrow;\r\n\r\n        //Actions\r\n        payParties(localAnscaEscrow);\r\n    }\r\n\r\n    // ##############################################################\r\n    // #####                                                    #####\r\n    // #################### Privileged actions ######################\r\n    // #####                                                    #####\r\n    // ##############################################################\r\n\r\n    function changeFeeCollectorAddress(address _adr) external {\r\n        require(msg.sender == owner);\r\n        feeCollectorAddress = _adr;\r\n    }\r\n\r\n    function changeFee(uint256 _fee) external {\r\n        require(msg.sender == owner && _fee <= 100);// 100 = 1%\r\n        FEE = _fee;\r\n    }\r\n\r\n    function pause(bool _pause) external {\r\n        require(msg.sender == owner);\r\n        paused = _pause;\r\n    }\r\n\r\n    // ##############################################################\r\n    // #####                                                    #####\r\n    // ########################### Internals  #######################\r\n    // #####                                                    #####\r\n    // ##############################################################\r\n\r\n    function isBuyerParty(AnscaEscrow memory _localAnscaEscrow, address _address) internal pure returns(bool) {\r\n        return _localAnscaEscrow.buyer == _address || (_address != address(0) && _localAnscaEscrow.buyerHandler == _address);\r\n    }\r\n\r\n    function isSellerParty(AnscaEscrow memory _localAnscaEscrow, address _address) internal pure returns(bool) {\r\n        return _localAnscaEscrow.seller == _address || (_address != address(0) && _localAnscaEscrow.sellerHandler == _address);\r\n    }\r\n\r\n    function payParties(AnscaEscrow memory _localAnscaEscrow) internal {\r\n        if(_localAnscaEscrow.discount > 0) {\r\n            payParty(_localAnscaEscrow, _localAnscaEscrow.buyer);\r\n        }\r\n        if(_localAnscaEscrow.discount < 100) {\r\n            payParty(_localAnscaEscrow, _localAnscaEscrow.seller);            \r\n        }\r\n    }\r\n\r\n    function payParty(AnscaEscrow memory _localAnscaEscrow, address _partyAddress) internal {\r\n        require((_partyAddress == _localAnscaEscrow.seller && !_localAnscaEscrow.sellerHasReceivedHisShare && _localAnscaEscrow.discount < 100) || \r\n                (_partyAddress == _localAnscaEscrow.buyer && !_localAnscaEscrow.buyerHasReceivedHisShare && _localAnscaEscrow.discount > 0)\r\n                , \"200\");\r\n\r\n        if(!_localAnscaEscrow.buyerHasReceivedHisShare && !_localAnscaEscrow.sellerHasReceivedHisShare) {\r\n            emitCompleteEvent(_localAnscaEscrow);\r\n        }\r\n\r\n        bool isBuyer = _partyAddress == _localAnscaEscrow.buyer;\r\n        if(isBuyer) {\r\n            anscaEscrowList[_localAnscaEscrow.id].buyerHasReceivedHisShare = true;\r\n        } else {\r\n            anscaEscrowList[_localAnscaEscrow.id].sellerHasReceivedHisShare = true;\r\n        }\r\n\r\n        // Actions        \r\n        uint256 part = isBuyer ? _localAnscaEscrow.amountMinusFee * _localAnscaEscrow.discount / 100 : _localAnscaEscrow.amountMinusFee - (_localAnscaEscrow.amountMinusFee * _localAnscaEscrow.discount / 100);\r\n        ACED aced = ACED(payable(_localAnscaEscrow.depositContract)); \r\n        if(_localAnscaEscrow.native) {\r\n            aced.withdraw(true, _partyAddress, part, address(0));\r\n        } else {\r\n            aced.withdraw(false, _partyAddress, part, _localAnscaEscrow.tokenAddress);\r\n        }\r\n    }\r\n\r\n    function startEscrow(AnscaEscrow memory _localAnscaEscrow) internal {\r\n        if(_localAnscaEscrow.state == State.NEW_SELLER) {\r\n            _localAnscaEscrow.buyer = msg.sender;\r\n        }\r\n        _localAnscaEscrow.state = State.ONGOING;\r\n        uint256 bts =  block.timestamp;\r\n        _localAnscaEscrow.startTimestamp = bts;\r\n\r\n        reputation[_localAnscaEscrow.seller].escrowNumber++;\r\n        if(reputation[_localAnscaEscrow.seller].firstEscrowDate == 0) {\r\n            reputation[_localAnscaEscrow.seller].firstEscrowDate = bts;\r\n        }\r\n        reputation[_localAnscaEscrow.seller].lastEscrowDate = bts;        \r\n\r\n        reputation[_localAnscaEscrow.buyer].escrowNumber++;\r\n        if(reputation[_localAnscaEscrow.buyer].firstEscrowDate == 0) {\r\n            reputation[_localAnscaEscrow.buyer].firstEscrowDate = bts;\r\n        }\r\n        reputation[_localAnscaEscrow.buyer].lastEscrowDate = bts;\r\n\r\n        _localAnscaEscrow.depositContract = address(new ACED());\r\n        ACED(payable(_localAnscaEscrow.depositContract)).setBuyer(_localAnscaEscrow.buyer);\r\n        ACED(payable(_localAnscaEscrow.depositContract)).setSeller(_localAnscaEscrow.seller);\r\n    }\r\n\r\n    function updateAction(AnscaEscrow memory _anscaEscrow, address _profil, Action _action, uint32 _nbr, bytes32 _str) internal {\r\n        uint256 bts =  block.timestamp;\r\n        address localProfil = isBuyerParty(_anscaEscrow, _profil) ? _anscaEscrow.buyer : _anscaEscrow.seller; \r\n        if(localProfil == _anscaEscrow.buyer) {\r\n            _anscaEscrow.buyerLastActionDate = bts;\r\n            _anscaEscrow.buyerLastAction = _action;\r\n            _anscaEscrow.buyerNbrVar = _nbr; \r\n            _anscaEscrow.buyerStrVar = _str;\r\n        } else {\r\n            _anscaEscrow.sellerLastActionDate = bts;\r\n            _anscaEscrow.sellerLastAction = _action;\r\n            _anscaEscrow.sellerNbrVar = _nbr; \r\n            _anscaEscrow.sellerStrVar = _str;\r\n        }\r\n        emitACEEvent(localProfil, _anscaEscrow.buyer, _anscaEscrow.seller, _anscaEscrow.id, _action);        \r\n    }\r\n\r\n    function emitACEEvent(address _from, address _buyer, address _seller, bytes32 _id, Action _action) internal {\r\n        emit ACEEvent(_from, _buyer, _seller, _id, uint8(_action));\r\n    }\r\n\r\n    function emitCompleteEvent(AnscaEscrow memory _anscaEscrow) internal {\r\n        emit CompleteEvent(_anscaEscrow.id, _anscaEscrow.amount, _anscaEscrow.dispute, _anscaEscrow.buyer, _anscaEscrow.seller, _anscaEscrow.tokenAddress);\r\n    }\r\n    \r\n    function isInOrGoingToBeOngoing(AnscaEscrow memory _escrow, bool _required) internal view returns(bool) {\r\n        if(isInOrGoingToBeDispute(_escrow, false) || isInOrGoingToBeComplete(_escrow, false)) {\r\n            if(_required) {\r\n            revert(\"R3\");\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if(_escrow.state != State.ONGOING && _escrow.state != State.ONGOING_LOCKED) {\r\n            if(_required) {\r\n            revert(\"R4\");\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function isInOrGoingToBeDispute(AnscaEscrow memory _escrow, bool _required) internal view returns(bool) {\r\n        if(_escrow.state == State.DISPUTE) {\r\n            if(isInOrGoingToBeComplete(_escrow, false)) {\r\n                if(_required) {\r\n                revert(\"R5\");\r\n                } else {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n\r\n        if(block.timestamp > (_escrow.startTimestamp + _escrow.deliveryTime) && _escrow.state == State.ONGOING_LOCKED)  {\r\n            return true;\r\n        }\r\n\r\n        if(_required) {\r\n            revert(\"R7\");\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    function isInOrGoingToBeComplete(AnscaEscrow memory _escrow, bool _required) internal view returns(bool) {\r\n\r\n        if(_escrow.state == State.COMPLETE || _escrow.buyerLastAction == Action.VALIDATE) {\r\n            return true;\r\n        }\r\n\r\n        uint256 bts = block.timestamp;\r\n\r\n        if(            \r\n            _escrow.state == State.ONGOING &&\r\n            _escrow.startTimestamp > 0 &&\r\n            bts > (_escrow.startTimestamp + _escrow.deliveryTime)\r\n        ) {\r\n            return true;\r\n        }\r\n\r\n        if(\r\n            _escrow.startTimestamp > 0 &&\r\n            bts > (_escrow.startTimestamp + _escrow.deliveryTime + dayInSecond) &&\r\n            bts > _escrow.sellerLastActionDate + dayInSecond &&\r\n            bts > _escrow.buyerLastActionDate + dayInSecond\r\n        ) {\r\n            return true;\r\n        }\r\n\r\n        if(_required) {\r\n            revert(\"R8\");\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n}", "ABI": "[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_feeCollectorAddress\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_dayInSecond\",\"type\":\"uint256\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"address\",\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"buyer\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"seller\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"id\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint8\",\"name\":\"action\",\"type\":\"uint8\"}],\"name\":\"ACEEvent\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"id\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"dispute\",\"type\":\"bool\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"buyer\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"seller\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"tokenAddress\",\"type\":\"address\"}],\"name\":\"CompleteEvent\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"FEE\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"acceptNewDeliveryTime\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"addressIsInvolved\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"cancelEscrow\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_fee\",\"type\":\"uint256\"}],\"name\":\"changeFee\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_adr\",\"type\":\"address\"}],\"name\":\"changeFeeCollectorAddress\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"changeHandler\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"counter\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"bool\",\"name\":\"_native\",\"type\":\"bool\"},{\"internalType\":\"address\",\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"_deliveryTime\",\"type\":\"uint32\"},{\"internalType\":\"bytes32\",\"name\":\"_label\",\"type\":\"bytes32\"},{\"internalType\":\"bool\",\"name\":\"_asBuyer\",\"type\":\"bool\"},{\"internalType\":\"address\",\"name\":\"_sellerAddress\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_handlerAddress\",\"type\":\"address\"}],\"name\":\"createEscrow\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"dayInSecond\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"address\",\"name\":\"_handlerAddress\",\"type\":\"address\"}],\"name\":\"deposit\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"escrowWentWell\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"getAddressReputation\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getAllEscrowsForSender\",\"outputs\":[{\"internalType\":\"bytes32[]\",\"name\":\"\",\"type\":\"bytes32[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"getEscrowById\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"bool\",\"name\":\"_lock\",\"type\":\"bool\"}],\"name\":\"lock\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bool\",\"name\":\"_pause\",\"type\":\"bool\"}],\"name\":\"pause\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"paused\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"uint32\",\"name\":\"_discount\",\"type\":\"uint32\"}],\"name\":\"proposeAmountDiscount\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"},{\"internalType\":\"uint32\",\"name\":\"_deliveryTime\",\"type\":\"uint32\"}],\"name\":\"proposeNewDeliveryTime\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"validateEscrow\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"withdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]", "ContractName": "ACE", "CompilerVersion": "v0.8.7+commit.e28d00a7", "OptimizationUsed": "1", "Runs": "200", "ConstructorArguments": "0000000000000000000000001a2d1f42323ea172fea32567c33f31a7539a379c0000000000000000000000000000000000000000000000000000000000015180", "EVMVersion": "Default", "Library": "", "LicenseType": "Unlicense", "Proxy": "0", "Implementation": "", "SwarmSource": "ipfs://66261144e0effb080e7bf2c9b5da3bf1f092fb6ee1709d409e2b5e0fccdd7937"}]}