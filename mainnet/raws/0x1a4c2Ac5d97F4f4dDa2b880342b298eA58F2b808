{"status": "1", "message": "OK", "result": [{"SourceCode": "pragma solidity 0.8.3;\r\n\r\nlibrary PineLendingLibrary {\r\n  struct LoanTerms {\r\n    uint256 loanStartBlock;\r\n    uint256 loanExpireTimestamp;\r\n    uint32 interestBPS1000000XBlock;\r\n    uint32 maxLTVBPS;\r\n    uint256 borrowedWei;\r\n    uint256 returnedWei;\r\n    uint256 accuredInterestWei;\r\n    uint256 repaidInterestWei;\r\n    address borrower;\r\n    }\r\n\r\n  function outstanding(LoanTerms calldata loanTerms, uint txSpeedBlocks) public view returns (uint256) {\r\n    // do not lump the interest\r\n    if (loanTerms.borrowedWei <= loanTerms.returnedWei) return 0;\r\n    uint256 newAccuredInterestWei = ((block.number + txSpeedBlocks -\r\n        loanTerms.loanStartBlock) *\r\n        (loanTerms.borrowedWei - loanTerms.returnedWei) *\r\n        loanTerms.interestBPS1000000XBlock) / 10000000000;\r\n    return\r\n        (loanTerms.borrowedWei - loanTerms.returnedWei) +\r\n        (loanTerms.accuredInterestWei -\r\n            loanTerms.repaidInterestWei) +\r\n        newAccuredInterestWei;\r\n  }\r\n\r\n  function outstanding(LoanTerms calldata loanTerms) public view returns (uint256) {\r\n    return outstanding(loanTerms, 0);\r\n  }\r\n\r\n  function nftHasLoan(LoanTerms memory loanTerms) public pure returns (bool) {\r\n      return loanTerms.borrowedWei > loanTerms.returnedWei;\r\n  }\r\n\r\n\r\n  function isUnHealthyLoan(LoanTerms calldata loanTerms)\r\n      public\r\n      view\r\n      returns (bool, uint32)\r\n  {\r\n      require(nftHasLoan(loanTerms), \"nft does not have active loan\");\r\n      bool isExpired = block.timestamp > loanTerms.loanExpireTimestamp &&\r\n          outstanding(loanTerms) > 0;\r\n      return (isExpired, 0);\r\n  }\r\n\r\n  event LoanInitiated(\r\n      address indexed user,\r\n      address indexed erc721,\r\n      uint256 indexed nftID,\r\n      LoanTerms loan\r\n  );\r\n  event LoanTermsChanged(\r\n      address indexed user,\r\n      address indexed erc721,\r\n      uint256 indexed nftID,\r\n      LoanTerms oldTerms,\r\n      LoanTerms newTerms\r\n  );\r\n  event Liquidation(\r\n      address indexed user,\r\n      address indexed erc721,\r\n      uint256 indexed nftID,\r\n      uint256 liquidated_at,\r\n      address liquidator\r\n  );\r\n}", "ABI": "[{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"erc721\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"nftID\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"liquidated_at\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"liquidator\",\"type\":\"address\"}],\"name\":\"Liquidation\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"erc721\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"nftID\",\"type\":\"uint256\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"indexed\":false,\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"loan\",\"type\":\"tuple\"}],\"name\":\"LoanInitiated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"erc721\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"nftID\",\"type\":\"uint256\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"indexed\":false,\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"oldTerms\",\"type\":\"tuple\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"indexed\":false,\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"newTerms\",\"type\":\"tuple\"}],\"name\":\"LoanTermsChanged\",\"type\":\"event\"},{\"inputs\":[{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"loanTerms\",\"type\":\"tuple\"}],\"name\":\"isUnHealthyLoan\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"},{\"internalType\":\"uint32\",\"name\":\"\",\"type\":\"uint32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"loanTerms\",\"type\":\"tuple\"}],\"name\":\"nftHasLoan\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"loanTerms\",\"type\":\"tuple\"},{\"internalType\":\"uint256\",\"name\":\"txSpeedBlocks\",\"type\":\"uint256\"}],\"name\":\"outstanding\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"components\":[{\"internalType\":\"uint256\",\"name\":\"loanStartBlock\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"loanExpireTimestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"interestBPS1000000XBlock\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"maxLTVBPS\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"borrowedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"returnedWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"accuredInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"repaidInterestWei\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"internalType\":\"struct PineLendingLibrary.LoanTerms\",\"name\":\"loanTerms\",\"type\":\"tuple\"}],\"name\":\"outstanding\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]", "ContractName": "PineLendingLibrary", "CompilerVersion": "v0.8.3+commit.8d00100c", "OptimizationUsed": "0", "Runs": "200", "ConstructorArguments": "", "EVMVersion": "Default", "Library": "", "LicenseType": "MIT", "Proxy": "0", "Implementation": "", "SwarmSource": "ipfs://aa0acd8e777afa75859b3a6b9714d318d208583b2f950d7f394c0c2ae9709d8a"}]}