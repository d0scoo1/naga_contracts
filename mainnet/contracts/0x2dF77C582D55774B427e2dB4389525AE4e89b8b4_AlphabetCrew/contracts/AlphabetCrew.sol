//SPDX-License-Identifier: MIT
/*
                                                               .J?PP7?.  .  ... ..                                                                    
                                                         . .:.....:^::7::::^^!!!7!                                                                    
                                                        ~?7777777????J?J????7!7Y5J                                                                    
                                                        .!!~~~!!!!!!!!!!!!!!!!7GBP.                                                                   
                                                         !7~~~~~7777777777777775BG^                                                                   
                                                         ^7~~~~~!77777777777777JGB!                                                                   
                                                         :7!~~~~!777777777777777GBJ                                                                   
                                                          77~~~~~777777777!!!!!7PB5                                                                   
                                                          ~7~~~~~777!!!!7?J5GB##&@&~                                                                  
                                                          ^?7~~~~7??J5GB&&@@@@@@@@@P                                                                  
                                                          ~@&####&&@@@@@@@@@@@@BG&@#                                                                  
                                                          .&@&&&&&BG#@@@@@@@@@G  .@@.                                                                 
                                                           B@&&&&P  .&@@@@@@@@&G5#@@~                                                                 
                                                           J@&&&&&GP#@@&&&&&B#@@@@@@J                                                                 
                                                           ^@@&&&&@@@@@&####&@@@@@@@B                                                                 
                                                            &@&&&&&@@@@@@@@@@@@@@@@@&                                                                 
                                                            P@&&&&&@@@@@@@@@@@@&&#BBG!                                                                
                         .JPPPPGP7                   .~7777~JBBBB##&&&&###BBBGPP55P!.  .7YYYYY?:                                                      
                        ^@@GGBGPG@&~                ?@@BB#B#@&P?5555555555PY?JGGB&@7  :@@#B##G&@P.                                                    
                        ~@@YYBB5?5@@!               #@&JBB5JG@&7Y#&&GB##GG&P?J&GJ&B~  ^@@5G&&YG#@&.                              .^~!!!^              
                        ^@@5YBBJPY&@#               #@#JBBYY?&@B7GBBGBG#5Y#JYP&&5Y#@B^^@@5G&&Y#P@@!                             5@&###B@&!            
             .^7?JY?!:  ~@@J5BBJ5J&@#..  .^!7!~:    &@#?BBYY?@@@@@&#B#B#GJ#YP#&&&B@@@&B@@PP&&JPY@@Y               :~7?J?!:     .&@#5&#7P&@B:.         
          :JB&#BBBBB#&#BB@@?PBB?Y?&&&##&#&#BBB####Y^&@#7BBJPJ&&&#&&&@&###P@&&BGGGGB#&@@@@BY&&YG5@@&###BGJ^    :JB&&###BBB#&GPBB#&&BY&&JYJ&&&&P.       
        ^B@&GGPPPPPGGPY5#@@?GBB?BJJPPP?PGPPGGGGG55&@@@#7BB?YJGGGGPJ?P#@&@&GGGPPPPPGG5JG&@GJ&&Y#YBPG##BGB#&&J:G@#PBBGP5PB#B5B@GGBBBG#&&#BB#5YB@&^      
       ^@@G7GPYYJ?77?BBY?J&?BBB7P7?BBG7YPPY5PYY5BGJ5@@G?#G~55Y?5YGB5J7B@&75G5YYJ777PBG7?GGY&&YYYB#BB#&&&#PP@@@P5&B5Y7YP5Y&#?Y?JGPGG&&#5BPPGBY&@#      
       .#@&G?~!!!5GG!YBB?PY?GBB?G77PBB5Y?5?!77!7?BB77&PYBB5JJ77?!~BB?G?&@#Y!!7!JPGY!BBYPJJ5&&5P#5GJJY7Y#&&JJ@BP&&GGY5GBGY&@JP75J?7~#&PBYJ7JJ?@@G      
       .B@#P5PPPPPPGP?BBJ5?7GBB7B775BB55P~5#&&#G!5#P7YY5BB?Y!#&@&7PB7P5B@G55PPPPPPG?GBPJJ7Y&&&BYJ75PPY?!#&&~BY&&G55PPPPPPPBJ5?@&&&7&&Y#?#&&&&@&~      
      .&@BJGB55YJ??J5BBBJJ7!PBB7P!?5BB5YYB@@@@@@YP#5YJ7PBG7YJ@@@@YGB75YPYPBP55J??JYGBBP?7!J&&&P5?&@@@@&~B&#7J?&&5#5?JJJJ7??J!Y@@@&J&&Y#7&@&J?7^       
      J@@7G#5YJ7Y5PJJBBBJP77GBB?GJ?5BBG5?G&&&&B5P#B?P!7GBPJYY@@@@YGB!5J7?#G?5!J5P57GBBPYJ!Y&&##55@@@@&B5&&PGJ7G@#PGP&&&&#PGB&&@@@&?&&J&7&@B           
      ?@@JJBBPJJB#GP57BBJ57?GBB?PJ75BB!7PPPPGGGBG5?5?Y?B#5?YP@@@@JBB!PJJ!GBG5?G#BPP7P#PJ?~G&&B7##BBBBB#&#PP57#~B&&GJ5BBBB##5P@@@@#?&&?#7&@B           
      .&@&7~YPP55P5YJ!GBYY?7PGG7P7~GBG?J7J5PPP5?JPY!J&7GBJYJB@@@&?GG7G?BP^?5PP55PYY!5BPJ?!P##GY?G#&&&#BP5BY?&@G~?GBBBB##GGG5J@@@@#7##J5!&@B           
       ^#@&5!7JJ7?J77?7YY?75!5P5Y!~BBG!G!!7?!?J?!??G@@Y!YJ?!&@@@@Y7YY?~#@B7!?J7???!?7JYJ~575BBGY!YJY5GBGJ?G@@&@&Y??J77Y5Y77J#@&&@&J7PPJ!&@B           
        :Y&@&#G5Y5PB&@#GBBB@GJJY?J!BBP!5!##BGGBB#&@@@@@GPGGG&@@@@@#PPPG&@@@#G5YJYP#@&GGBG&&5YYJJBB5YY5PG#@@&P?G&@&BP5YY5G#&@&#5Y#&@#GGG#@@P           
          ^?5B#&&&&#GG######&&&&@&~BBP?G!&@@@@&#BBGGPPG#@@@&##B&@&###B@@@&##BGGGGPG#@@&#&#&@@@@##&#&@@@@####&&Y!5G#&&&&&&#BP?:  ^JG#&&#BPY:           
             .:^^^^:..:::::^7JJ&@&~GBGJB!&@@#5P########G5#@J#&JJPB##BY5&B5BBG5JJPB&PJB5G&GJG&@&?##GJP&@GG##?P@@^ .:~!7?7~^.       .^^^:..             
                               G@@77PPJ5!&@Y5&&5JJ?YPGG#G?&?&&!G#P5PPGY7G&BYY!PBB7B&YY7J&&JPG@JB&&#YG5&J&&PPPB@&.                                     
                               !&@&Y?J?~?@#7&&?7YGGPJJJB5J&7&&GPYJ7J57~Y&&BGPPGGGPB&P5?!#&JYPG5&PB&JPYJB&B?B7#@@:                                     
                                7B&@&&&&&@5P&#!&@@@@&5Y5P&#?&&PP75#&#BYB&G5555555JY5Y?7?P&P???&#?5&GGJY&&7B55@@P                                      
                                 .75GGG#@@YB&#J@@@@@@@@&@@BY&&J55@@#@@5G&BPB?55Y5YY?55PGY&#7?#&?B?&&5Y&&55#!&@&:                                      
                                       !@@GJ&&PG&&@@&&BGB#BJ&&JYB@&!&@#!&&GPY#&&&&GBGB@&7&&GB&YBG~G&PG&#7#JP@@Y                                       
                                       .&@&?5&&#BGGBGB##GY5Y&#?JG@&.G@@J?#&#PYGBBB#BGJ&@?P&&&5JBJG?&&&&YPP7&@&.                                       
                                        7&@&7!5BB##BBBPPB5?JBBY7G@@.:#@@5~J5GGGGBG55Y?&@B!5BBJ#YY@Y5BBGJ&?B@@7                                        
                                         J&@&PJ?7?5J55YJYG&Y?YY7#@@. :P&@#5J???7JY?JG&@&@#YYGP7!&@&J?PG5?J@@G                                         
                                          !G&@@&BPP55PB&@&&@&#&&@&G    !P&&&&##B#&&@&B?!G&@#B#B#@@@@#GGGP&@@~                                         
                                           .~JPB&&&&&&#GJ~!YPPY?7~.     .:!?5PGBG5J7^.  .~5GGGGGP?7P####&&BY                                          
                                               :^~!!~^:.                      ...          .....   .::::^^:                  
*/
pragma solidity ^0.8.4;

import "erc721a/contracts/ERC721A.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";
import "@openzeppelin/contracts/utils/Strings.sol";


contract AlphabetCrew is Ownable, ERC721A, ReentrancyGuard {
    bool public isMintActive = false;
    bool public isWhitelistActive = false;

    string private _baseTokenURI;

    uint256 public constant maxMint = 10;
    uint256 public constant collectionSize = 11111;

    uint256 public constant preSale = 0.0333 ether;
    uint256 public constant publicSale = 0.0444 ether;

    mapping(address => uint256) public whitelist;
    mapping(address => uint256) public freelist;

    constructor() ERC721A("alphabet crew", "ABC") {
    }

    modifier callerIsUser() {
        require(tx.origin == msg.sender, "The caller is another contract");
        _;
    }

    function whitelistMint(uint256 quantity) external payable callerIsUser {
        require(isWhitelistActive, "whitelist sale has not begun yet");
        require(whitelist[msg.sender] > 0, "not eligible for whitelist mint");
        require(totalSupply() + quantity <= collectionSize, "reached max supply");
        require(msg.value >= preSale * quantity, "Ether value sent is not correct");
        require(quantity <= maxMint, "quantity greater than max mint");

        whitelist[msg.sender]--;
        _safeMint(msg.sender, quantity);

    }

    function freeMint() external callerIsUser {
        require(isWhitelistActive || isMintActive, "free mint has not begun yet");
        require(freelist[msg.sender] > 0, "not eligible for free mint");
        require(totalSupply() + 1 <= collectionSize, "reached max supply");

        freelist[msg.sender]--;
        _safeMint(msg.sender, 1);
    }

    function setMintActive(bool mintState) public onlyOwner {
        isMintActive = mintState;
    }

    function setWhitelistActive(bool mintState) public onlyOwner {
        isWhitelistActive = mintState;
    }

    function seedWhitelist(address[] memory addresses, uint256 numAllowedToMint) external onlyOwner {
        for (uint256 i = 0; i < addresses.length; i++) {
          whitelist[addresses[i]] = numAllowedToMint;
        }
    }

    function seedFreelist(address[] memory addresses) external onlyOwner {
        for (uint256 i = 0; i < addresses.length; i++) {
          freelist[addresses[i]] = 1;
        }
    }

    function _baseURI() internal view virtual override returns (string memory) {
        return _baseTokenURI;
    }

    function setBaseURI(string calldata baseURI) external onlyOwner {
        _baseTokenURI = baseURI;
    }

    function withdrawMoney() external onlyOwner nonReentrant {
        (bool success, ) = msg.sender.call{value: address(this).balance}("");
        require(success, "Transfer failed.");
    }


    function numberMinted(address owner) public view returns (uint256) {
        return _numberMinted(owner);
    }

    function getOwnershipData(uint256 tokenId) external view returns (TokenOwnership memory) {
        return _ownershipOf(tokenId);
    }

    function mint(uint256 quantity) external payable callerIsUser {
        require(isMintActive, "whitelist sale has not begun yet");
        require(totalSupply() + quantity <= collectionSize, "reached max supply");
        require(msg.value >= publicSale * quantity, "Ether value sent is not correct");
        require(quantity <= maxMint, "quantity is greater than max mint");

        _safeMint(msg.sender, quantity);
    }

    function _startTokenId() internal pure override returns (uint256) {
        return 1;
    }
}
