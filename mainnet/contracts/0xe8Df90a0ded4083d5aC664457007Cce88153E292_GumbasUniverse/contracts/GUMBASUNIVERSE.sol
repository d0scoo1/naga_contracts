//   .       *             .         .
//                 .                      .
//   .       .       .'          .
//                  '.              *        .
//      .   '        .'     .              .
//  __        .    .'          ______        __
//    |          o'           |      |      |  |
//    |                       |      |      |  |
//    |                       |      |   ___|  |_
//  __|_______________________|__..--~~~~ jro    ~--.
//                    /|\
//                   /   \
//                  /  |  \
//                 /       \
//   \|/          /    |    \
//               /           \
//              /      |      \    "Boy, are you ever
//             /               \  a genius, Harry! Only
//            /        |        \ a total IDIOT like YOU,
//           /                    would run out of gas in
//          /   ____   |           the MIDDLE OF NOWHERE,
//         /   /  __)         ___ at THREE IN THE MORNING!"
//        /    \(~oo   |     (___)  /
//       /     _\_-/_       (_o o_)
//      /     /  \/  \ |    (_\O/_)(\ \
//     /     / /    \ \     //\_/\\//  \
//    /      \_\    | /    //(_ _)\/    \
//            \_)___|/     \\/   \       \    \|/
//             /    |      (/_____\
//            /  /| |        | |\ \
//            \  \| |        | | \ \
//             \__\_|        |_|  \_\
//             (__]__)       <_>  /\_>
//
//  % % % % % % % % % % % % % % % % % % % % % % % % % %
//   % % % % % % % % % % % % % % % % % % % % % % % % % %
//
//        .       .    )        .           .
//   .       *             .         .
//                 .                      .
//   .       .       .'          .
//                  '.              *        .
//      .   '        .'     .              .
//              _.---._   .            .     *
//    *       .'       '.
//        _.-~===========~-._
//       (___________________)       .   *
//  __         \_______/       ______        __
//    |                       |      |      |  |
//    |                       |      |      |  |
//    |                       |      |   ___|  |_
//  __|_______________________|__..--~~~~ jro    ~--.
//                    /|\
//                   /   \
//                  /  |  \
//                 /       \
//   \|/          /    |    \
//               /           \    "It's probably a HUNDRED
//              /      |      \    MILES to a gas station!
//             /               \   This wind is RUINING MY
//            /        |        \   HAIR! Why I married a
//           /                     FOOL like YOU, I'll NEVER
//          /   ____   |           KNOW! My parents TOLD ME
//         /   /  __)         ___   you were no good!..."
//        /    \(~oo   |     (___)  /
//       /     _\_-/_       (_o o_)
//      /     /  \/  \ |    (_\O/_)   \
//     /     / /    \ \     //\_/\\    \
//    /      \ |    /_/    //(_ _)\\    \
//   /        \|___(_/     \\/   \//     \    \|/
//             |    \      (/_____\)
//             | |\  \      / /| |
//             | |/  /      \ \| |
//             |_/__/        \_|_|
//            (__[__)        <_<_>
//
//  * * * * * * * * * * * * * * * * * * * * * * * * * *
//   * * * * * * * * * * * * * * * * * * * * * * * * *
//
//  "We only have room
//   for one specimen,       "Let us take the small,
//   Gumba King. Which shall     high-decible one, Gumba Queen.
//      we take?"               It has less mass."
//             \  _.-'~~~~'-._   /
//      .      .-~ \__/  \__/ ~-.         .
//           .-~   (oo)  (oo)    ~-.
//          (_____//~~\\//~~\\______)
//     _.-~`                         `~-._
//    /O=O=O=O=O=O=O=O=O=O=O=O=O=O=O=O=O=O\     *
//    \___________________________________/
//               \x x x x x x x/
//       .  *     \x_x_x_x_x_x/
//  jro
//
//  @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @
//   @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @ @
//
//          .                            *
//                    _.-'~~~~'-._
//      .          .-~ \__/  \__/ ~-.         .
//               .-~   (oo)  (oo)    ~-.
//              (_____//~~\\//~~\\______)
//         _.-~`                         `~-._
//        /O=O=O=O=O=O=O=O=O=O=O=O=O=O=O=O=O=O\
//        \___________________________________/
//                   \x x x x x x x/
//                    \x_x_x_x_x_x/
//                     :|. | ' ."
//                     | |. '. |:| Zzuzz!
//                     | :  |:. ;|
//    "Ohmygosh, a     . | : .|  :
//    flying saucer!   | . | : .||
//    - !Delores! -"   : |. | . ::  Zzuzz!
//        \    ___     |.: |. :. |
//            /  _)    | :|___ |:|
//           |  (~o   (\.|(___)  /)
//           _\/_/_    \\(_O O_)//   Zzuzz!
//          /      \   .\(_\O/_)/:
//         / /    \ \  :|\/\_/\/ |
//         \ |    | /  | .(_ _): |
//          \|____|/   .| /   \ |:
//           |_  _|    | /_____\.| !!!EEEEKKKK!!!
//           | |  |    : .| | | .
//           | |  |    .  | | | ||
//           |_|__|    | :|_|_| .:
//   jro     [__[__)   .: <_|_> .|
//
//  jrojrojrojrojrojrojrojrojrojrojrojrojrojrojro
//  jrojrojrojrojrojrojrojrojrojrojrojrojrojrojro
//
//
//      .       .    )        .           .
//   .       *             .         .
//               .                      .
//   .       .                   .
//                                *        .
//      .   '               .              .
//              _.---._   .            .     *
//    *       .'       '.
//        _.-~===========~-._
//       (___________________)       .   *
//  __  .'     \_______/   .'  ______        __
//    |              .'  .'   |      |      |  |
//    |             '         |      |      |  |
//    |                       |      |   ___|  |_
//  __|_______________________|__..--~~~~ jro    ~--.
//                    /|\
//                   /   \
//                  /  |  \
//                 /       \
//   \|/          /    |    \
//               /           \
//              /      |      \
//             /               \
//            /
//           /       "BRING MY WIFE BACK,
//          /    __  YOU COSMIC KIDNAPPERS!"
//         /    /  \ /
//        /    (\__/)  |            \
//       /     _\__/_                \
//      /     /      \ |              \
//     /     / /   / /                 \
//           \ |   \_\                  \
//            \|____\_)                  \    \|/
//             |    \
//             | |\  \
//             | |/  /
//             |_/__/
//            (__[__)
//
//  8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8
//   8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8
//
//        .       .    )        .           .
//   .       *             .         .
//                 .                      .
//   .       .          o        .
//                    .'            *        .
//      .   '       .'      .              .
//  __        .   .'           ______        __
//    |           '.          |      |      |  |
//    |            .'         |      |      |  |
//    |                       |      |   ___|  |_
//  __|_______________________|__..--~~~~ jro    ~--.
//                    /|\
//                   /   \
//                  /  |  \
//                 /       \
//   \|/          /    |    \
//               /           \
//              /      |      \
//             /               \
//            /        |        \
//           /   _               \
//          /   /_\    |          \
//         /    \_/                \
//        /    /   \   |            \
//       /     \|_|/                 \
//      /       |||    |              \
//     /        |||                    \
//    /        (_|_)   |                \
//   /                                   \    \|/
//
//  # # # # # # # # # # # # # # # # # # # # # # # #
//   # # # # # # # # # # # # # # # # # # # # # # # #
//
//        .       .    )        .           .
//   .       *             .         .
//                 .                      .
//   .       .                   .
//                                  *        .
//      .   '               .              .
//  __        .                ______        __
//    |                       |      |      |  |
//    |                       |      |      |  |
//    |                       |      |   ___|  |_
//  __|_______________________|__..--~~~~ jro    ~--.
//                    /|\
//                   /   \
//                  /  |  \
//                 /       \
// \|/             /    |    \
//               /           \
//              /
//             /   "Cripes, that WAS stupid! What
//            /     if they'd actually HEARD me
//           /        and brought her BACK!"
//          /   ____   /
//         /   /  __)              \
//        /    \(~oo   |            \
//       /     _\_o/_                \
//      /     /  \/  \ |              \
//     /     / /    \ \                \
//    /      \ |    /_/                 \
//   /        \|___(_/                   \    \|/
//             |    \
//             | |\  \
//             | |/  /
//             |_/__/
//            (__[__)
//Contract based on [https://docs.openzeppelin.com/contracts/3.x/erc721](https://docs.openzeppelin.com/contracts/3.x/erc721)
// SPDX-License-Identifier: MIT
pragma solidity 0.8.12;

import "@openzeppelin/contracts/access/Ownable.sol";
import 'erc721a/contracts/ERC721A.sol';
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";
import '@openzeppelin/contracts/utils/Strings.sol';

contract GumbasUniverse is ERC721A, Ownable, ReentrancyGuard {
    string public baseURI = "ipfs://QmTAoPBQwhRRvX8xe8soPn6YjE8Y3eREvH3S3KNYWgrnA1/";
    uint   public price             = 0.005 ether;
    uint   public maxPerTx          = 20;
    uint   public maxPerFree        = 2;
    uint   public totalFree         = 6000;
    uint   public maxSupply         = 10000;

    mapping(address => uint256) private _mintedFreeAmount;

    constructor() ERC721A("Gumbas Universe", "GUMBASUNIVERSE"){}


    function tokenURI(uint256 _tokenId) public view virtual override returns (string memory) {
        require(_exists(_tokenId),"ERC721Metadata: URI query for nonexistent token");
        string memory currentBaseURI = _baseURI();
        return bytes(currentBaseURI).length > 0
            ? string(abi.encodePacked(currentBaseURI,Strings.toString(_tokenId+1),".json"))
            : "";
    }

    function mint(uint256 count) external payable {
        uint256 cost = price;
        bool isFree = ((totalSupply() + count < totalFree + 1) &&
            (_mintedFreeAmount[msg.sender] < maxPerFree));

        if (isFree) {
            require(msg.value >= (count * cost) - cost, "INVALID_ETH");
            require(totalSupply() + count <= maxSupply, "No more");
            require(count <= maxPerTx, "Max per TX reached.");
            _mintedFreeAmount[msg.sender] += count;
        }
        else{
            require(msg.value >= count * cost, "Please send the exact amount.");
            require(totalSupply() + count <= maxSupply, "No more");
            require(count <= maxPerTx, "Max per TX reached.");
        }

        _safeMint(msg.sender, count);
    }

    function Gumba(address mintAddress, uint256 count) public onlyOwner {
        _safeMint(mintAddress, count);
    }

    function _baseURI() internal view virtual override returns (string memory) {
        return baseURI;
    }

    function setBaseUri(string memory baseuri_) public onlyOwner {
        baseURI = baseuri_;
    }

    function setPrice(uint256 price_) external onlyOwner {
        price = price_;
    }

    function setMaxTotalFree(uint256 MaxTotalFree_) external onlyOwner {
        totalFree = MaxTotalFree_;
    }

	function withdraw(uint amount) public onlyOwner {
		require(payable(msg.sender).send(amount));
	}

}