// SPDX-License-Identifier: Unlicensed

/*
ApeBank Token (APEBANK)

Website: http://ape-bank.xyz
Twitter: https://twitter.com/weareapebank
Telegram: https://t.me/apebankpreverify

&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&5?P&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#?. .J&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B~ !5~ !#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&P: ?#@#7 ^G&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&J.:Y&&&&&Y..Y&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#7 ^G&&&&&&&P^ 7#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&###&&&&G^ !#@&&&&&&&@#~ ~G&&&&##&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B5?~^::P&&&J..^7YG#&&&#GY7^..Y&&&5::^!?5B&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&P!: .~7JY#&&&&5: .::^!?!:::. ^P&&&&BYJ7^. :7G&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#7. ^YB&&&&&&&&&&B!.^557~?5Y^.7#&&&&&&&&&&BY^ .?#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#~ .?#&&&&&&&&&&&&&&J.:Y&@&J.:Y&&&&&&&&&&&&&@#7. !#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&? .7&&&&&&&&&&&&&&&&&P^ 7P! ~G&&&&&&&&&&&&&&&&&!..J&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&~..P&&&&&&&&&&&&&&&&&&#7. .?#&&&&&&&&&&&&&&&&&&5..!@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#G5Y:..G&&&&&&&&&&&&&&&&&&&&5?P&&&&&&&&&&&&&&&&&&&&5..^Y5G&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#J^......G&&&&&&&&&#BG5555PB#&@@@&#BP555PGB&&&&&&&&&&P......^J#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B^ .7GG:.:B&&&&&&#P7^........^!5BY!:........~B&&&&&&&&P..^BP7. ~#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&? .?&@B:.:B&&&&&5~  ~?5GBBGPJ!. . .!YPGBBG5J5#&&&&&&&&G..^#@&!. Y&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&? .?@&B:.:B&&&&?. ~P&&&&&@@&&&G7~?B&&&@@&&&&&&&BPB&&&&B:.^#&&7. Y&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&G:.:P@B:.^#&&&5..~#&&&&&#PG&&&&&&&&&&#PP#&&&&&&!.:P&&&B:.:#@P: :B&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&5: :JY..^#&&&7..Y@&&&&B^..7&&&&&&&&#!..~B&&&&&?. ?&&&B:.:5?. ^P&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B?: ...~#&&&? .7&&&&&P.  ~#&&&&&&&#^  .G&&&&&!..Y&&&#^... ^JB&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#P7..~&&&&B^ .Y&&&&&P?JB&&&&&&&&&G??P&&&&#J. ~#&&&#^..?P#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@5..!&&&&&B!. ~5B&&@@&&&&&&&&&&&&&@@&&BY~ .!B&&&&&~..G@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&Y..!&&&&&&&5!. .~!?B&&&&&&&&&&&&&G7!^. :!P&&&&&&&~..P&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&Y..7&&&&&&&&&B57. .G&&&&&&&&&&&&&5. .?PB&&&&&&&&&!..5&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&5..!&&&&&&&&&&@P..!&&&&&&&&&&&&&&#^..G@&&&&&&&&&&~..P&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B^..P@&&&&&&&&&G..^#&&&&&&&&&&&&&B:.:B&&&&&&&&&@5..~#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&5..^G&&&&&&&&&&?..!B&&&&&&&&&&&G~..J&&&&&&&&&&P:.:P&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&5: .J#&&&&&&&&&J: :?G#&&&&&#P?: :Y&&&&&&&&&B?. ^P&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B7^~B&&&&&&&&&&B?^..:~!!!^: .^JB&&&&&&&#P7: :?B&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&!: .^Y5B&&&&&&#GY?!~~~!?YG#&&&&&&BY!: .^JB&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&Y. .~JP#&&@@@@&&&&@@@@@&&#P?~. :!YG&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&B57^. :~7Y5GBBB#BBGG5J7~: .^?P#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#GY7~:.....:::.....:~?5G#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&#BGP5YYYYY5PGB#&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
*/


pragma solidity 0.8.13;

import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/utils/math/SafeMath.sol";

import "./interface/IUniswap.sol";

contract APEBANK is ERC20, Ownable {
    using SafeMath for uint256;

    IUniswapV2Router02 public uniswapV2Router;
    address public immutable uniswapV2Pair;

    bool private inSwapAndLiquify;

    bool public swapAndLiquifyEnabled = true;

    bool public enableEarlySellTax = true;

    uint256 public maxSellTransactionAmount = 10000 * (10**18);
    uint256 public maxBuyTransactionAmount = 2000 * (10**18);
    uint256 public maxWalletToken = 4000 * (10**18);
    uint256 public swapTokensAtAmount = 10 * (10**18);

    uint256 private buyTotalFees = 10;
    uint256 public sellTotalFees = 10;
    uint256 public earlySellTotalFee = 20;

    uint256 public burnFee = 0;
    address public deadWallet = 0x000000000000000000000000000000000000dEaD;
    
    uint256 public liquidityPercent = 40;

    uint256 public treasuryPercent = 30; 
    uint256 public marketingPercent = 20; 
    uint256 public devPercent = 10; 

    uint256 totalWalletRewardsPercent;
    uint256 totalTeamWalletRewardsPercent;

    address payable public liquidityWallet = payable(0x701Fd87560C8743c23bdC164FC00D8AFBa2425c5);

    address payable public treasuryWallet = payable(0xF7906486265d916e8978Add49Bc56e187d6e2DFe);
    address payable public marketingWallet = payable(0xC3145a81a1e8B8706cDF6C47332AED5f628de562);
    address payable public devWallet = payable(0x84BcA3F73092dfc979e5c6043768F6D380ebea0F);
    
    mapping (address => bool) private _isExcludedFromFees;

    mapping (address => bool) public automatedMarketMakerPairs;
    mapping (address => uint256) public lastTxTimestamp;

    event UpdateUniswapV2Router(address indexed newAddress, address indexed oldAddress);
    event LiquidityWalletUpdated(address indexed newLiquidityWallet, address indexed oldLiquidityWallet);

    event ExcludeFromFees(address indexed account, bool isExcluded);

    event SetAutomatedMarketMakerPair(address indexed pair, bool indexed value);

    event GasForProcessingUpdated(uint256 indexed newValue, uint256 indexed oldValue);

    event SwapAndLiquifyEnabledUpdated(bool enabled);

    event SwapAndLiquify(
        uint256 tokensIntoLiqudity,
        uint256 ethReceived
    );

    event ChangeWalletRewardPercents(
        uint256 newLiquidityPercent, 
        uint256 newTreasuryPercent, 
        uint256 newMarketingPercent, 
        uint256 newDevPercent,
        uint256 newTotalWalletRewardsPercent,
        uint256 newTotalTeamWalletRewardsPercent
    );

    modifier lockTheSwap {
        inSwapAndLiquify = true;
        _;
        inSwapAndLiquify = false;
    }

    constructor() ERC20("ApeBank Token", "APEBANK") {

    	IUniswapV2Router02 _uniswapV2Router = IUniswapV2Router02(0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D);

        address _uniswapV2Pair = IUniswapV2Factory(_uniswapV2Router.factory())
            .createPair(address(this), _uniswapV2Router.WETH());

        uniswapV2Router = _uniswapV2Router;
        uniswapV2Pair = _uniswapV2Pair;

        _setAutomatedMarketMakerPair(_uniswapV2Pair, true);

        excludeFromFees(owner(), true);

        excludeFromFees(liquidityWallet, true);
        excludeFromFees(treasuryWallet, true);
        excludeFromFees(marketingWallet, true);
        excludeFromFees(devWallet, true);
        excludeFromFees(address(this), true);

        totalWalletRewardsPercent = liquidityPercent + treasuryPercent + marketingPercent + devPercent;
        totalTeamWalletRewardsPercent = treasuryPercent + marketingPercent + devPercent;
        
        _mint(owner(), 100000 * (10**18));
    }

    receive() external payable {

  	}

    function changeWalletRewardPercents(
        uint256 newLiquidityPercent, 
        uint256 newTreasuryPercent, 
        uint256 newMarketingPercent,
        uint256 newDevPercent
    ) external onlyOwner {
        liquidityPercent = newLiquidityPercent;
        treasuryPercent = newTreasuryPercent;
        marketingPercent = newMarketingPercent;
        devPercent = newDevPercent;

        totalWalletRewardsPercent = newLiquidityPercent + newTreasuryPercent + newMarketingPercent + newDevPercent;
        totalTeamWalletRewardsPercent = newTreasuryPercent + newMarketingPercent + newDevPercent;

        emit ChangeWalletRewardPercents(
            newLiquidityPercent, newTreasuryPercent, newMarketingPercent, newDevPercent, 
            totalWalletRewardsPercent, totalTeamWalletRewardsPercent
        );
    }

    function updateUniswapV2Router(address newAddress) public onlyOwner {
        require(newAddress != address(uniswapV2Router), "Byrdov: The router already has that address");
        uniswapV2Router = IUniswapV2Router02(newAddress);
        emit UpdateUniswapV2Router(newAddress, address(uniswapV2Router));
    }

    function excludeFromFees(address account, bool excluded) public onlyOwner {
        require(_isExcludedFromFees[account] != excluded, "ApeBank Token: Account is already the value of 'excluded'");
        _isExcludedFromFees[account] = excluded;

        emit ExcludeFromFees(account, excluded);
    }
   
    function setAutomatedMarketMakerPair(address pair, bool value) public onlyOwner {
        require(pair != uniswapV2Pair, "ApeBank Token: The UniSwap pair cannot be removed from automatedMarketMakerPairs");

        _setAutomatedMarketMakerPair(pair, value);
    }

    function _setAutomatedMarketMakerPair(address pair, bool value) private {
        require(automatedMarketMakerPairs[pair] != value, "ApeBank Token: Automated market maker pair is already set to that value");
        automatedMarketMakerPairs[pair] = value;

        emit SetAutomatedMarketMakerPair(pair, value);
    }
    
    function isExcludedFromFees(address account) public view returns(bool) {
        return _isExcludedFromFees[account];
    }
   
    function setSwapAndLiquifyEnabled(bool _enabled) public onlyOwner {
        swapAndLiquifyEnabled = _enabled;
        emit SwapAndLiquifyEnabledUpdated(_enabled);
    }

    function setMaxSellTransaction(uint256 _maxSellTxAmount) public onlyOwner {
        require(maxSellTransactionAmount>totalSupply().div(1000), "value is too low");
        maxSellTransactionAmount = _maxSellTxAmount;
    }
    
    function setMaxBuyTransaction(uint256 _maxBuyTxAmount) public onlyOwner {
        require(maxBuyTransactionAmount>totalSupply().div(1000), "value is too low");
        maxBuyTransactionAmount = _maxBuyTxAmount;
    }

    function setMaxWalletToken(uint256 _maxToken) external onlyOwner {
        require(maxWalletToken>totalSupply().div(1000), "value is too low");
        maxWalletToken = _maxToken;
  	}

    function setSwapTokensAtAmount(uint256 _newAmount) public onlyOwner {
        swapTokensAtAmount = _newAmount;
    }

    function updateLiquidityWallet(address payable newLiquidityWallet) public onlyOwner {
        excludeFromFees(newLiquidityWallet, true);
        liquidityWallet = newLiquidityWallet;
        emit LiquidityWalletUpdated(newLiquidityWallet, liquidityWallet);
    }
    
    function setTreasuryWallet(address payable wallet) public onlyOwner {
        treasuryWallet = wallet;
    }

    function setMarketingWallet(address payable wallet) public onlyOwner {
        marketingWallet = wallet;
    }

    function setDevWallet(address payable wallet) public onlyOwner {
        devWallet = wallet;
    }

    function updateBuyTotalTax(uint256 _buyTotalFees) public onlyOwner {
        require(buyTotalFees <= 15, "Fee too high");
        buyTotalFees = _buyTotalFees;
    }

   function updateSellTotalTax(uint256 _sellTotalFees) public onlyOwner {
        require(sellTotalFees <= 15, "Fee too high");
        sellTotalFees = _sellTotalFees;
    }

    function updateEarlySellTotalTax(uint256 _earlySellTotalFee) public onlyOwner {
        require(earlySellTotalFee <= 20, "Fee too high");
        earlySellTotalFee = _earlySellTotalFee;
    }

    function setEarlySellTax(bool onoff) external onlyOwner  {
        enableEarlySellTax = onoff;
    }

    function setAutoBurn(uint256 _burnFee) external onlyOwner  {
        require(_burnFee <= 5, "value too high");
        burnFee = _burnFee;
    }

    function swapTokensForEth(uint256 tokenAmount) private {
        address[] memory path = new address[](2);
        path[0] = address(this);
        path[1] = uniswapV2Router.WETH();

        if(allowance(address(this), address(uniswapV2Router)) < tokenAmount) {
          _approve(address(this), address(uniswapV2Router), ~uint256(0));
        }

        uniswapV2Router.swapExactTokensForETHSupportingFeeOnTransferTokens(
            tokenAmount,
            0, 
            path,
            address(this),
            block.timestamp
        );
        
    }

    function addLiquidity(uint256 tokenAmount, uint256 ethAmount) private {
        uniswapV2Router.addLiquidityETH{value: ethAmount}(
            address(this),
            tokenAmount,
            0, 
            0, 
            liquidityWallet,
            block.timestamp
        );        
    }

    function swapAndLiquify(uint256 contractTokenBalance) private lockTheSwap {
        uint256 previousContractETHBalance = address(this).balance;

        uint256 tokensForLiquidity = contractTokenBalance.mul(liquidityPercent).div(totalWalletRewardsPercent); 
        uint256 halfForETH = tokensForLiquidity.div(2); 
        uint256 otherHalfForTokens = tokensForLiquidity.sub(halfForETH); 

        swapTokensForEth(halfForETH); 
        uint256 ethReceivedFromSwapForLiquidity = address(this).balance.sub(previousContractETHBalance);
        addLiquidity(otherHalfForTokens, ethReceivedFromSwapForLiquidity); 

        uint256 tokensForTeamWallets = contractTokenBalance.sub(tokensForLiquidity); 

        swapTokensForEth(tokensForTeamWallets); 

        uint256 ethForTreasuryWallet = address(this).balance.mul(treasuryPercent).div(totalTeamWalletRewardsPercent); 
        treasuryWallet.transfer(ethForTreasuryWallet);

        uint256 ethForMarketingWallet = address(this).balance.mul(marketingPercent).div(totalTeamWalletRewardsPercent.sub(treasuryPercent)); 
        marketingWallet.transfer(ethForMarketingWallet);
        
        uint256 ethForDevWallet = address(this).balance;
        devWallet.transfer(ethForDevWallet); 

        emit SwapAndLiquify(otherHalfForTokens, ethReceivedFromSwapForLiquidity); 
    }

    function _transfer(address from, address to, uint256 amount) internal override {
        require(from != address(0), "ERC20: transfer from the zero address");
        require(to != address(0), "ERC20: transfer to the zero address");

        if(amount == 0) { 
            super._transfer(from, to, 0);
            return;
        }
        
        if(automatedMarketMakerPairs[from] && (!_isExcludedFromFees[from]) && (!_isExcludedFromFees[to])) {
            require(amount <= maxBuyTransactionAmount, "amount exceeds the maxBuyTransactionAmount.");
            uint256 contractBalanceRecipient = balanceOf(to);
            require(contractBalanceRecipient + amount <= maxWalletToken,"Exceeds maximum wallet token amount.");
            lastTxTimestamp[to] = block.timestamp;
            
        }

        if(automatedMarketMakerPairs[to] && (!_isExcludedFromFees[from]) && (!_isExcludedFromFees[to])) {
            require(amount <= maxSellTransactionAmount, "amount exceeds the maxSellTransactionAmount.");
        }
        
    	uint256 contractTokenBalance = balanceOf(address(this));
        
        bool contractTokenBalanaceIsEnoughToSwapAndLiquify = contractTokenBalance >= swapTokensAtAmount;
       
        if(
            contractTokenBalanaceIsEnoughToSwapAndLiquify &&
            !inSwapAndLiquify &&
            automatedMarketMakerPairs[to] && 
            swapAndLiquifyEnabled
        ) {
            contractTokenBalance = swapTokensAtAmount;
            swapAndLiquify(contractTokenBalance);
        }

        uint256 fees = 10;
        uint256 burnShare = 0;

        if(!_isExcludedFromFees[from] && !_isExcludedFromFees[to]) {
            uint256 _totalFees = buyTotalFees;

            if (automatedMarketMakerPairs[to]) {   
                uint256 span = block.timestamp - lastTxTimestamp[from];
                if(enableEarlySellTax && span <= 24 hours) {
                    _totalFees = earlySellTotalFee;
                }
                else if(!enableEarlySellTax) {
                    _totalFees = sellTotalFees;
                }
            }

            fees = amount.mul(_totalFees).div(100);
            burnShare = amount.mul(burnFee).div(100);
            if(fees > 0) {
                super._transfer(from, address(this), fees);
            }

            if(burnShare > 0) {
                super._transfer(from, deadWallet, burnShare);
            }

            amount = amount.sub(fees.add(burnShare));
        }

        super._transfer(from, to, amount);

    }

}