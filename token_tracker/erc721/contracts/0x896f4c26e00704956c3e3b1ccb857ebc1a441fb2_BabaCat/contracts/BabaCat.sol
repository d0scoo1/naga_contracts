/**********************************************************************************************  


     ▄▄▄▄    ▄▄▄       ▄▄▄▄    ▄▄▄      ▒███████▒ ▒█████   ███▄ ▄███▓ ▄▄▄▄    ██▓▓█████ 
    ▓█████▄ ▒████▄    ▓█████▄ ▒████▄    ▒ ▒ ▒ ▄▀░▒██▒  ██▒▓██▒▀█▀ ██▒▓█████▄ ▓██▒▓█   ▀ 
    ▒██▒ ▄██▒██  ▀█▄  ▒██▒ ▄██▒██  ▀█▄  ░ ▒ ▄▀▒░ ▒██░  ██▒▓██    ▓██░▒██▒ ▄██▒██▒▒███   
    ▒██░█▀  ░██▄▄▄▄██ ▒██░█▀  ░██▄▄▄▄██   ▄▀▒   ░▒██   ██░▒██    ▒██ ▒██░█▀  ░██░▒▓█  ▄ 
    ░▓█  ▀█▓ ▓█   ▓██▒░▓█  ▀█▓ ▓█   ▓██▒▒███████▒░ ████▓▒░▒██▒   ░██▒░▓█  ▀█▓░██░░▒████▒
    ░▒▓███▀▒ ▒▒   ▓▒█░░▒▓███▀▒ ▒▒   ▓▒█░░▒▒ ▓░▒░▒░ ▒░▒░▒░ ░ ▒░   ░  ░░▒▓███▀▒░▓  ░░ ▒░ ░
    ▒░▒   ░   ▒   ▒▒ ░▒░▒   ░   ▒   ▒▒ ░░░▒ ▒ ░ ▒  ░ ▒ ▒░ ░  ░      ░▒░▒   ░  ▒ ░ ░ ░  ░
     ░    ░   ░   ▒    ░    ░   ░   ▒   ░ ░ ░ ░ ░░ ░ ░ ▒  ░      ░    ░    ░  ▒ ░   ░   
     ░            ░  ░ ░            ░  ░  ░ ░        ░ ░         ░    ░       ░     ░  ░
          ░                 ░           ░                                  ░           

==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
==========================================================================================
=====================*==========*=========================================================
===================*##*=======*##*========================================================
=================*#####=====*#####*=======================================================
===============*###**###***#####**#*======================================================
==============%##+++::::::::=###***##=====================================================
=============%#+%%%%+--:--:-*%%%#####=============================-==:::==================
=============%-%@@@@#*::::=%..%=%####=============================-:---=::================
-===-===-===-%-%@@@=--===-+=.=%=%####===-===-===-===-===-===-===-===-::--=::-===-===-===-=
==============-..= ===%%%**== =---*##=================================-::--=::============
=============*=--+=*#.#.#.#.**%---*##===================================-::-= ============
===============*%%%-==#=#=#++%#######++==================================::-= ============
=================**%%++++++%###*##**##%==================================::-= ============
=======================%*******%##%%%%%%*************======================+*:============
=======================@=#+##%%#########################**==============+**##=============
================--+:==:%-#-#:#:#===#####**********##########*==========***##*=============
===============-==--=====+=+=+=+===*****************##########*********#*##*==============
==================++====-#-#+#+###+#****************#####################*================
==+====+====+====+====+==%##################################*****######*+====+====+====+==
=+++==+++==+++==+++==+++==%#########################*****###++++==+++==+++==+++==+++==+++=
==+====+====+====+====+====%#########+--------------+****###==+====+====+====+====+====+==
=+++==+++==+++==+++==+++==++%########=================#**###=+++==+++==+++==+++==+++==+++=
=============================@%#=%###=============*%%%**#*##==============================
==============================@++=%#================*%*+=*###=============================
-------------------------------*.--=: ----------------+.---+: ----------------------------
-------------------------------+.--=: ----------------+.---+: ----------------------------
-------------------------------+.--=: ----------------+.---+: ----------------------------
==============================+-===-:================+-===+-:=============================
==========================================================================================
==========================================================================================
==========================================================================================
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


BabaZ is a web3 zombie world.
You can earn money, make friends and play games in this metaverse.

web: https://babaz.io/Cat
twitter: https://twitter.com/babaz_nft
discord: https://discord.com/invite/Baburefype

email: babaz.nft@gmail.com


**********************************************************************************************/

// SPDX-License-Identifier: MIT
pragma solidity ^0.8.4;

// Ownable
import "@openzeppelin/contracts/access/Ownable.sol";

// local contract
import "./Withdrawable.sol";
import "./ERC721Opensea.sol";
import "./PublicSalesActivation.sol";

// BabaCat contract
contract BabaCat is
    Ownable,
    PublicSalesActivation,
    Withdrawable,
    ERC721Opensea  
    
{
    // quantitative restrictions
    uint256 public constant TOTAL_MAX_QTY = 9527;
    uint256 public constant GIFT_MAX_QTY = 2000;
    uint256 public constant MAX_QTY_PER_MINTER = 10; 
    uint256 public constant SALES_MAX_QTY = TOTAL_MAX_QTY - GIFT_MAX_QTY;

    // minter
    mapping(address => uint256) public salesMinterToTokenQty;

    // sales
    uint256 public salesMintedQty = 0;
    uint256 public giftedQty = 0;

    // init
    constructor() ERC721("BabaCat", "BBC") {}

    // not other contract
    modifier callerIsUser() {
        require(tx.origin == msg.sender, "not user!");
        _; 
    } 
 
    // free mint
    function freeMint(uint256 _mintQty)
        external
        isPublicSalesActive
        callerIsUser
    {
        require(
            salesMintedQty + _mintQty <= SALES_MAX_QTY,
            "Exceed sales max limit"
        );
        require(
            salesMinterToTokenQty[msg.sender] + _mintQty <=  MAX_QTY_PER_MINTER,
            "Exceed max mint per minter"
        );

        salesMinterToTokenQty[msg.sender] += _mintQty;
        salesMintedQty += _mintQty;

        for (uint256 i = 0; i < _mintQty; i++) {
            _safeMint(msg.sender, totalSupply() + 1);
        }
        
    }

    // airdrop
    function gift(address[] calldata receivers) external onlyOwner {

        require(
            giftedQty + receivers.length <= GIFT_MAX_QTY,
            "Exceed gift max limit"
        );

        giftedQty += receivers.length;

        for (uint256 i = 0; i < receivers.length; i++) {
            _safeMint(receivers[i], totalSupply() + 1);
        }

    } 


}
